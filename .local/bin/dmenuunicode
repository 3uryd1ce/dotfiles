#!/usr/bin/env sh
# rewrite of Luke Smith's dmenuunicode:
# https://github.com/LukeSmithxyz/voidrice/blob/master/.local/bin/dmenuunicode

# his dotfiles can be accessed here:
# https://github.com/LukeSmithxyz/voidrice
set -e

emoji_file="${HOME}/.local/share/emoji"

# TODO
# figure out a way to get a consistent display with fontconfig
emoji_font="Symbola-16"

err() {
  printf "%s\\n" "[$(date +'%Y-%m-%d|%H:%M:%S')]: $*" >&2
  exit 1
}

import_colors() {
  . "${HOME}/.cache/wal/colors.sh"
}

menu() {
  dmenu -i -l 20 \
    -fn "${emoji_font}" \
    -nb "${color0}" \
    -nf "${color3}" \
    -sb "${color0}" \
    -sf "${color7}"
}

grab_emoji() {
  chosen=$(cut -d ';' -f1 "${emoji_file}" | menu)
  emoji=$(printf "%s" "${chosen}" | sed "s/ .*//")
  printf "%s" "${emoji}" | xclip -selection clipboard
}

dmenuunicode() {
  import_colors
  grab_emoji
}

dmenuunicode
