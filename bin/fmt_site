#!/usr/bin/env sh
set -e

INDEX="/home/ashlen/builds/website/index.html"
ABOUT_ME="/home/ashlen/builds/website/about-me.html"
SOFTWARE="/home/ashlen/builds/website/software.html"
SELFHOSTING="/home/ashlen/builds/website/selfhosting.html"
PROJECTS="/home/ashlen/builds/website/projects.html"
CLUES="/home/ashlen/builds/website/clues.html"
NIXOS="/home/ashlen/builds/website/nixos.html"

INDEX_TITLE="<title>aml: there's no place like /home</title>"
ABOUT_ME_TITLE='<title>aml: about me and my interests </title>'
SOFTWARE_TITLE='<title>aml: useful free software I enjoy</title>'
SELFHOSTING_TITLE='<title>aml: ways I host free software and why you should self-host too</title>'
PROJECTS_TITLE='<title>aml: projects I work on</title>'
CLUES_TITLE='<title>aml: get a clue</title>'
NIXOS_TITLE='<title>aml: thoughts on NixOS</title>'

INDEX_DESCR='<meta name="description" content="/home page for amissing.link, my personal website dedicated to tech and my eclectic list of hobbies.">'
ABOUT_ME_DESCR='<meta name="description" content="Describes my personality and interests, as one might expect of an about me page.">'
SOFTWARE_DESCR='<meta name="description" content="Lists free software I use or otherwise enjoy along with the resources I use to find those programs.">'
SELFHOSTING_DESCR='<meta name="description" content="Explains why you should self-host if you can and lists resources conducive to that.">'
PROJECTS_DESCR='<meta name="description" content="Source code for my projects, managed with git and generated with stagit.">'
CLUES_DESCR='<meta name="description" content="Small, precise tidbits of information not confined to any particular subject.">'
NIXOS_DESCR="<meta name='description' content='The pros and cons of NixOS from an OpenBSD user's perspective.'>"


add_titles_and_descriptions () {
if ! grep -i "${INDEX_TITLE}" "${INDEX}"; then
sed -i "/<!--UTF-8/a \\
  ${INDEX_TITLE} \\
  ${INDEX_DESCR} \\
" "${INDEX}"
fi

if ! grep -i "${ABOUT_ME_TITLE}" "${ABOUT_ME}"; then
sed -i "/<!--UTF-8/a \\
  ${ABOUT_ME_TITLE} \\
  ${ABOUT_ME_DESCR} \\
" "${ABOUT_ME}"
fi

if ! grep -i "${SOFTWARE_TITLE}" "${SOFTWARE}"; then
sed -i "/<!--UTF-8/a \\
  ${SOFTWARE_TITLE} \\
  ${SOFTWARE_DESCR} \\
" "${SOFTWARE}"
fi

if ! grep -i "${SELFHOSTING_TITLE}" "${SELFHOSTING}"; then
sed -i "/<!--UTF-8/a \\
  ${SELFHOSTING_TITLE} \\
  ${SELFHOSTING_DESCR} \\
" "${SELFHOSTING}"
fi

if ! grep -i "${PROJECTS_TITLE}" "${PROJECTS}"; then
sed -i "/<!--UTF-8/a \\
  ${PROJECTS_TITLE} \\
  ${PROJECTS_DESCR} \\
" "${PROJECTS}"
fi

if ! grep -i "${CLUES_TITLE}" "${CLUES}"; then
sed -i "/<!--UTF-8/a \\
  ${CLUES_TITLE} \\
  ${CLUES_DESCR} \\
" "${CLUES}"
fi

if ! grep -i "${NIXOS_TITLE}" "${NIXOS}"; then
sed -i "/<!--UTF-8/a \\
  ${NIXOS_TITLE} \\
  ${NIXOS_DESCR} \\
" "${NIXOS}"
fi
}

remove_trailing_whitespace () {
  for i in ${INDEX} ${ABOUT_ME} ${SOFTWARE} ${SELFHOSTING} ${PROJECTS} ${CLUES} ${NIXOS}
  do
    sed -i 's/\s\+$//g' "${i}"
  done
}

add_titles_and_descriptions
remove_trailing_whitespace
